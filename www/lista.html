<!DOCTYPE html>
<html>

<head>
  <meta http-equiv='cache-control' content='no-cache'>
  <meta http-equiv='expires' content='0'>
  <meta http-equiv='pragma' content='no-cache'>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="themes/gas-rojo.min.css">
  <link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
  <!--link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css"-->
  <link rel="stylesheet" href="themes/jquery.mobile.structure-1.4.5.min.css" />
  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/jquery.mobile-1.4.5.min.js"></script>

</head>

<body>

  <div data-role="page" id="pageone">
    <div data-role="panel" id="mypanel">

      <!-- panel content goes here -->

      <ul data-role="listview" data-inset="false">
        <li data-icon="edit"><a id="linkregistrar" href="javascript:window.location.href = 'insumo.html'">Registrar</a>
          </li>
        <li data-icon="search"><a id="linkBuscar" href="javascript:window.location.href = 'lista.html'">Buscar</a>
        </li>
        <li data-icon="calendar"><a id="linkAgendar" href="javascript:window.location.href = 'agendar.html'">Agendar</a>
        </li>
        <li data-icon="grid"><a id="linkReporte" href="javascript:window.location.href = 'reporte.html'">Reportes</a>
        </li>
        <li data-icon="user"><a id="linkCliente" href="javascript:window.location.href = 'cliente.html'">Cliente</a>
        </li>
        <li data-icon="gear"><a id="linkUsuario" href="javascript:window.location.href = 'cliente.html">Usuario</a></li>
        <li data-icon="power"><a id="linkCerrar" href="javascript:window.location.href = 'index.html'">Cerrar</a></li>
      </ul>


    </div><!-- /panel -->


    <div data-role="header">
      <a href="#mypanel" id="cambiaVentana"
        class="ui-btn ui-shadow ui-corner-all ui-btn-inline ui-btn-icon-left ui-icon-bars ui-btn-icon-notext "></a>
      <h1>Bitacora</h1>

    </div>
    <div class="ui-content">

      <ul data-role="listview" data-inset="true" id="lista"  data-filter="true" data-filter-placeholder="Buscar por..." >
      </ul>
      <br>
      <label for="cdireccion">RFC:</label>
      <input type="text" data-clear-btn="true" name="xcrfc" id="xcrfc" value="MAAJ830101U41">

      <input type="button" data-icon="search" value="Buscar" id="buscar" onclick="buscar()">


    </div>

    <div data-role="footer">
      <h1>OperaGAS</h1>
    </div>
  </div>


  <script type="text/javascript">
    function buscar() {

      showLoading();
      var params = "crfc=" + $("#xcrfc").val();//+"r:"+Math.random();
      //console.info(params);
      $.ajax({
        url: "http://www.dratl.com.mx/inmuebles/gas/gasWeb/mvc/view/gas/consulta.php",
        method: "GET",
        data: params, success: function (result) {
          // console.info("result:",result);
          var rows = $.parseJSON(result);

          var $ul = $("#lista");
          $ul.empty();
          $.each(rows, function (i, obj) {
            var tipopago = obj.idtipopago == "1" ? "EFECTIVO" : "TARJETA";
            var content = '<li data-icon="info"  ><a href="#">' + '(' + obj.idsuministro + ') ' + tipopago + ' ' + obj.fecha + '</a></li>';
            $ul.append(content);
          });
          $ul.listview( "refresh" );
        }, complete: function () {
          hideLoading();
        }
      });

    }

    /***************** funciones loading ***********************/
    function hideLoading() {

      $.mobile.loading('hide', {
        text: 'Cargando',
        textVisible: true,
        theme: 'z',
        html: ""
      });
    }
    function showLoading() {

      $.mobile.loading('show', {
        text: 'Cargando',
        textVisible: true,
        theme: 'z',
        html: ""
      });
    }
    /***********************************************************/
  </script>
</body>
</html>